<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mente Maestra: Desafío Matemático</title>
    
    <!-- PWA Config -->
    <meta name="theme-color" content="#4f46e5">
    <meta name="msapplication-navbutton-color" content="#4f46e5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Mente Maestra">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Manifest dinámico -->
    <link rel="manifest" id="my-manifest">
    
    <style>
        /* Animaciones Globales */
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        .shake { animation: shake 0.2s ease-in-out; }

        @keyframes redPulse {
            0%, 100% { box-shadow: inset 0 0 0 rgba(255, 0, 0, 0); background-color: rgb(243 244 246); }
            50% { box-shadow: inset 0 0 150px rgba(220, 38, 38, 0.4); background-color: rgb(254 226 226); }
        }
        .urgent-pulse-bg { animation: redPulse 1s infinite; transition: all 0.3s ease; }

        @keyframes fall {
            0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        .confetti { position: fixed; width: 12px; height: 12px; top: -20px; z-index: 9999; pointer-events: none; }

        /* Ocultar hints en móvil */
        .key-hint {
            position: absolute; bottom: -10px; right: -10px; background: #333; color: white;
            width: 24px; height: 24px; border-radius: 4px; display: flex; align-items: center;
            justify-content: center; font-size: 12px; font-weight: bold; box-shadow: 2px 2px 0px rgba(0,0,0,0.2);
        }
        @media (max-width: 768px) { .key-hint { display: none; } }

        .scrollbar-thin::-webkit-scrollbar { width: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 3px; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        body { visibility: hidden; touch-action: manipulation; min-height: 100vh; } 
    </style>
</head>
<body class="bg-gray-100 text-gray-900 font-sans selection:bg-indigo-200 selection:text-indigo-900">
    <div id="root"></div>

    <!-- IMPORTANTE: Aquí cargamos el script principal como MÓDULO -->
    <script type="module" src="./js/app.js"></script>

    <!-- Script auxiliar para el Manifiesto PWA y Service Worker -->
    <script>
        // Generar Manifest
        const manifest = {
            "name": "Mente Maestra",
            "short_name": "MenteMaestra",
            "start_url": ".",
            "display": "standalone",
            "orientation": "portrait",
            "background_color": "#f3f4f6",
            "theme_color": "#4f46e5",
            "description": "Juego de agilidad mental matemática.",
            "icons": [{ "src": "https://raw.githubusercontent.com/lucide-icons/lucide/main/icons/brain.svg", "sizes": "512x512", "type": "image/svg+xml", "purpose": "any maskable" }]
        };
        const blob = new Blob([JSON.stringify(manifest)], {type: 'application/json'});
        document.querySelector('#my-manifest').setAttribute('href', URL.createObjectURL(blob));

        // Service Worker Dummy para instalación
        if ('serviceWorker' in navigator) {
            const swContent = `self.addEventListener('install', (e) => { self.skipWaiting(); }); self.addEventListener('fetch', (e) => {});`;
            const swBlob = new Blob([swContent], { type: 'application/javascript' });
            navigator.serviceWorker.register(URL.createObjectURL(swBlob)).catch(() => {});
        }
    </script>
</body>
</html>